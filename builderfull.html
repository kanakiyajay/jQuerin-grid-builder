<html>
<head>
    <title>jQuerin Grid Builder</title>
<link rel="stylesheet" href="builder/builder.css">
<style type="text/css">

</style>
<!--
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>              
                
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33060097-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>-->
</head>
<body>         
                <div> 

                    <ul id="header">
                        <li>
                            
                                <a href="#" title="The jQuerin Grid Builder"><p class="banner">jQuerin Grid Builder</p>
                                    <div>jQuerin Grid Builder</div></a>
                                                        
                        </li>
                        <li>
                            <a href="http://www.responsivegridsystem.com" target="_blank" title="the responsive grid system">
                             <p class="banner">
                                <img src="builder/grid.jpg" alt="">
                            </p>
                            <div>
                                Based on Responsive Grid System
                            </div>
                            </a>
                        </li>
                        <li id="howtouse">
                            <a href="">
                                <p class="banner">
                                    <img src="builder/howtouse.png" alt="">
                                </p>
                                <div>
                                    How to use?
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/kanakiyajay/jQuerin-grid-builder" title="jQuerin Grid Builder on GitHub" target="_blank">
                                <p class="banner">
                                <img src="builder/github.png" alt="">
                                </p>  
                                <div>
                                    Fork me on GitHub
                            </div>
                            </a>
                        </li>
                        <li>
                            <a href=""><p class="banner">
                                    <img src="builder/share.jpg" alt="">
                                </p>
                                    <div>
                                        <a href="https://twitter.com/share" class="twitter-share-button" data-text="Make way for the awesome grid builder" data-via="techiejayk" data-size="small">Tweet</a>
                                </div></a>
                        </li>
                        <li>
                            <a href="http://www.quora.com/Grid-based-Design-web/What-features-should-be-there-in-the-jquerin-grid-builder" target="_blank" title="feedback for jQuerin Grid Builder on Quora">
                                <p class="banner">
                                <img src="builder/quora.jpg" alt="">
                                </p>
                                <div>
                                    Feedback on Quora
                                </div>
                            </a>
                        </li>

                            
                    </ul>
                
                </div>
                <div id="toolbox">
                    
                </div>
                <div id="codebutton">
                      Generate Code
                </div>
                <div id="built"><a href="http://twitter.com/techiejayk" target="_blank" title="Jay Kanakiya">By Jay Kanakiya</a></div>
                <div id="dynamicwrapper">
                    <div id="dynamic">
                    
                </div>
                <div id="placeholder"></div>   
                <div class="buttoner" id="buttonerrow">
                    <div class="wrapperbutton" id="addrow">
                        <div>Add Row</div>
                    </div>
                    <div class="wrapperbutton" id="deleterow">
                        <div>Delete Row</div>
                    </div>
                </div>
                </div>

            <div id="generatedcode">
                <h1>Copy this html code in your favourite code editor</h1>
                <div id="modalclose"></div><pre name="code" id="thefinalhtmlcode" class="htmlCode"></pre>
                <h1>Save in the same directory as style.css</h1><pre id="thefinalcsscode" name="code" class="cssCode"></pre>
                <a href="http://jquer.in" target="_blank" title="The unofficial jquery plugin page | jQuer.in | Search Less, Play More">
                    <div id="jquerin">
                        The unofficial jquery plugins page
                    </div></a>
            </div>
            <div class="fullyhidden">
<!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->

            </div>
            <div class="fullyhidden" id="footerarea">
<!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/libs/jquery-1.7.1.min.js"><\/script>')</script>-->
</div>
                <div class="fullyhidden" id="resetcss">
/*Resetting css for consistency*/
html, body, div, span, object, iframe,h1, h2, h3, h4, h5, h6, p, blockquote, 
pre,abbr, address, cite, code,del, dfn, em, img, ins, kbd, q, samp,small, strong,
sub, sup, var,b, i,dl, dt, dd, ol, ul, li,fieldset, form, label, legend,table, caption,
tbody, tfoot, thead, tr, th, td,article, aside, canvas, details,figcaption, figure,
footer, header, hgroup, menu, nav, section, summary,time,mark, 
audio, video {margin: 0;padding: 0;border: 0;outline: 0;font-size: 100%;vertical-align: baseline;background: transparent;}
 body {line-height: 1;}
 article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section { display: block;}
 nav ul {list-style: none;}
 blockquote, q {quotes: none;}blockquote:before, blockquote:after,q:before, q:after {content: '';content: none;}
 a {margin: 0;padding: 0;font-size: 100%;vertical-align: baseline;background: transparent;}
 ins {background-color: #ff9;color: #000;text-decoration: none;}
 mark {background-color: #ff9;color: #000;
 font-style: italic;font-weight: bold;}del {text-decoration:  line-through;}
 abbr[title], dfn[title] {border-bottom: 1px dotted;cursor: help;}
 table {border-collapse: collapse;border-spacing: 0;}
 hr {display: block;height: 1px;border: 0; border-top: 1px solid #cccccc;margin: 1em 0;padding: 0;}
 input, select {  vertical-align: middle;}
.col {float:left;height:100%;}
</div>

<script type="text/javascript" src="builder/jquery.min.js"></script>
<script type="text/javascript" src="builder/jquery-ui.min.js"></script>
<script type="text/javascript" src="builder/jquery.editinplace.js"></script>
<script type="text/javascript" src="builder/jquery.snippet.min.js"></script>
<script type="text/javascript" src="builder/jquery.scrollto.min.js"></script>
<script type="text/javascript" src="builder/jquery.aSimpleTour.js"></script>
<script type="text/javascript">

$(document).ready(function () {
    
    $('.fullyhidden').hide();

    //Global Variables
    //These are for live manipulation
    var mainwidth = $(this).width() //-16;
    var rownumber;
    var data_divide;
    var data_width;
    var alltheblocks;
    var dividewidth;
    var blockwidth;
    var universalid=1;
    var $beforeselected=$('.fullyhidden');
    var remove = $('.remove');
    var left = $('.left');
    var right = $('.right');
    var addsubcol = $('.addsubcol');
    var addsubrow = $('.addsubrow');
    //These are for the html code to be generated
    var awesomecontent = '';
    var thehidden = $('.fullyhidden').first();
    var headerarea = thehidden.next().html().toString();
    var footerarea = $('#footerarea').html().toString();
    var resetcss = $('#resetcss').html().toString();
    var block_ka_html = '';
    var fullhtmlcode = '';
    var awesomecss = '';
    var mediaqueries = '';
    var heights = '/*Heights*/';
    var subrowobject='';
    var datadividesub='';
    var data_height='';
    var number=1;
    var cssforheights='/*These are the heights of the subrows*/\n';
    var widtharray = [];
    //A sImple Tour 
    options = {
      data : [
       { element : '#addrow', 'tooltip' : 'click here to add rows', 'position' : 'BL', 'text' : '<h4>Rows have blue border</h4>' },
        { element : '#toolbox', 'tooltip' : 'Change the attributes by clicking on text', 'position' : 'R', 'text' : '<h4>The toolbox</h4>' },
        { element : '#placeholder', 'tooltip' : 'click here to add cols', 'position' : 'L', 'text' : '<h4>Blocks have green border</h4>' },
        { element : '#toolbox', 'tooltip' : 'Increase , Decrease, Delete ,Add Subrows to Blocks', 'position' : 'R' }
      ],
      controlsPosition : 'RT'
    }
    $('#howtouse').on("click",function  () {
        
        $.aSimpleTour(options);
        
    });
    //MENU HOVER
    $("li").hover(
      function () {
        $(this).find('.banner').addClass('hovered');
      }, 
      function () {
        $(this).find('.banner').removeClass('hovered');
      }
    );
    //On adding a row
    $('#addrow').on("click", function () {
        universalid = universalid +1;
        var blankrow = '<div class="dynamicrow ui-widget-content" data-divide="0" id="' + universalid + '"><p>Height : <span>200</span>px</p><div class="fixedblockoptions" ><b>Row</b><div class="blockinfo" data-id="'+universalid+'">#<span class="editblockid" data-id="">ID</span><br/>.<span class="editblockclass" data-class="">Class</span><br/>//<span class="editblockcomment" data-comment="">Comment</span></div></div><div class="theblock"><button class="addblock"><br>C<br>O<br>L</button></div></div>';//row_ka_html

        $('#deleterow').show();
        var blankrowkaid = '#'+universalid;
        $(blankrow).appendTo($('#dynamic'));
        intoolbox($(blankrowkaid));//for editing


        $(".addblock").unbind('click');//Still not sure why?
        $('.addblock').click(function () {
            universalid=universalid+1;
            var blankblock = '<div class="dynamicblock" data-width="1" data-height="0" id="'+universalid+'"><div class="fixedblockoptions" ><b>Column</b><div class="blockinfo" data-id="'+universalid+'">#<span class="editblockid" data-id="">ID</span><br/>.<span class="editblockclass" data-class="">Class</span><br/>//<span class="editblockcomment" data-comment="">Comment</span></div><div class="right"><p>Increase</p></div><div class="left"><p>Decrease</p></div><div class="remove"><p>Delete</p></div><div class="addsubrow"><p>SubRow</p></div></div></div>';//block_ka_html

            var $selectedrow = $(this).parent().parent();
            var $blankblock = $(blankblock); //cache
             intoolbox($blankblock);
             refresh();            
            //for same Height
            var therowheight = $selectedrow.css('height');
            
            //increase data-divide of row by 1 on adding a block
            data_divide = $selectedrow.attr('data-divide');
            data_divide = parseInt(data_divide) + 1 ;
            $selectedrow.attr('data-divide',data_divide);


            $blankblock.appendTo($selectedrow); //live append
            //change block widths of that row
            $selectedrow.children('.dynamicblock').each(function(){

                var $this = $(this);
                data_width = $this.attr('data-width');
                data_width = parseInt(data_width);
                blockwidth = (100/data_divide)*data_width;
                $this.children('p').children('span').text(Math.round(blockwidth));
                blockwidth = blockwidth + '%';
                $this.css('width', blockwidth);
                

            });
            rightfun();
            leftfun();
            removefun();
            subrowfun();
            subcolfun(); 
             
            //HOVER
            $('.dynamicblock').unbind('click');//still not sure why?
            //on hover show the options
            $(".dynamicblock").on("click",function () {
                $(this).css('background-color','lightblue');
                intoolbox($(this));//for editing
                refresh();
                rightfun();
                leftfun();
                removefun();
                subrowfun();
                subcolfun(); 

            });
        });

        //to resize heights of row
        $(".dynamicrow").resizable({
            maxHeight: 800,
            minHeight: 10,
            handles: "se",
            resize: function (event, ui) {
                ui.size.width = ui.originalSize.width;
            },
            stop: function (event, ui) {

                $(this).children('p').children('span').text(Math.round(ui.size.height) + 1);

            }
        });
    });       

    //For deleting the last Row
    $('#deleterow').on("click",function  () {

        $('.dynamicrow').last().remove();

    });
    //Hide when modal close is clicked
    $('#modalclose').on("click",function  () {
        //resetting all the variables
        awesomecontent = '';
        block_ka_html = '';
        fullhtmlcode = '';
        awesomecss = '';
        mediaqueries = '';
        heights = '/*Heights*/';
        widtharray=[];
        $('#generatecode').html('');
        $('#generatedcode').hide();
        $('.ui-resizable-handle').show();
    
    });
    //The Awesome Code for html grid content generated
    $('#codebutton').on("click", function () {
        $('.ui-resizable-handle').hide();
        $('#generatedcode').show();
        generatecode(); //function for better understanding

           fullhtmlcode = '<!--Built with jQuerin Grid Builder-->\n<!doctype html>\n<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"><![endif]-->\n<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->\n<!--[if IE 8]><html class="no-js lt-ie9" lang="en"> <![endif]-->\n<head>\n<meta charset="utf-8">\n<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">\n<title></title>\n<meta http-equiv="cleartype" content="on">\n<meta name="description" content="">\n<meta name="viewport" content="width=device-width">\n<meta name="HandheldFriendly" content="True">\n<meta name="MobileOptimized" content="320">\n<link rel="stylesheet" href="style.css">\n</head>\n<body>\n' + headerarea + awesomecontent + '\n</body>\n</html>';
                fullhtmlcode = fullhtmlcode.replace(/undefined/g, "");
                fullhtmlcode = fullhtmlcode.replace(/id=""/g, "");

                $('#thefinalhtmlcode').text(fullhtmlcode);

                // The Full css code generated
                var fullcsscode = resetcss + awesomecss + heights +cssforheights +'\n/*Make it responsive dude*/\n\n@media only screen and (max-width: 480px) {\n' + mediaqueries + '}';
                $('#thefinalcsscode').text(fullcsscode);
                //Dynmaic snippet load and syntav highlight
                //$.getScript("builder/jquery.snippet.min.js", function() {

                    $("pre.htmlCode").snippet("html",{style:"matlab"//,clipboard:'builder/ZeroClipboard.swf',showNum:true
                });
                    $("pre.cssCode").snippet("css",{style:"bright"//,clipboard:'builder/ZeroClipboard.swf',showNum:true
                });
                   

    });
var rightfun = function  () {
            right.unbind('click');//not sure why?
            right.on("click",function () {
                
                var thatnumber = $(this).siblings('.blockinfo').attr('data-id');
                thatnumber = '#'+thatnumber;
                var thatblock = $(thatnumber);//cache
                var $selectedrow = thatblock.parent();//cache

             
                data_divide = parseInt($selectedrow.attr('data-divide'));
                 if(data_divide!==1) 
                 {

                    data_divide = data_divide + 1;
                    $selectedrow.attr('data-divide',data_divide); //for data-divde

                    data_width  = parseInt(thatblock.attr('data-width'));
                    data_width  = data_width + 1;
                    thatblock.attr('data-width',data_width);//for data-width
                    thatblock.attr('data-width',data_width);

                }


                //show the left button
                thatblock.find('.left').show();
                //resize all the rows
                $selectedrow.children('.dynamicblock').each(function(){

                    var $this = $(this);
                    data_width = $this.attr('data-width');
                    data_width = parseInt(data_width);
                    blockwidth = (100/data_divide)*data_width;
                    //$this.children('p').children('span').text(Math.round(blockwidth));
                    blockwidth = blockwidth + '%';
                    $this.css('width', blockwidth);
                    
                });

                reallocatewidths($selectedrow);
                deleteleft($selectedrow);
                intoolbox(thatblock);
                refresh();leftfun();
            });
}
var leftfun = function  () {
     left.unbind('click');//not sure why?
                //If Present reduces data-width by 1 
             left.on("click",function () {
                    var thatnumber = $(this).siblings('.blockinfo').attr('data-id');
                    thatnumber = '#'+thatnumber;
                    var thatblock = $(thatnumber);//cache
                    var $selectedrow = thatblock.parent();//cache

                    data_width  = thatblock.attr('data-width');
                    if (data_width!==1) 
                    {
                        data_width  = parseInt(data_width) - 1;
                        thatblock.attr('data-width',data_width); //for data-width

                        data_divide = parseInt($selectedrow.attr('data-divide'));
                        data_divide = data_divide - 1;
                        $selectedrow.attr('data-divide',data_divide); 
                    }//for data-divde        
                    
                    //resize all the rows
                    $selectedrow.children('.dynamicblock').each(function(){

                        var $this = $(this);
                        data_width = $this.attr('data-width');
                        data_width = parseInt(data_width);
                        blockwidth = (100/data_divide)*data_width;
                        //$this.children('p').children('span').text(Math.round(blockwidth));
                        blockwidth = blockwidth + '%';
                        $this.css('width', blockwidth);
                        
                    });

                    reallocatewidths($selectedrow);
                    deleteleft($selectedrow);
                    intoolbox(thatblock);

                    
                });
}
var removefun = function  () {
    remove.unbind('click');//not sure why?
                //Delete a block
                remove.on("click",function (){

                    var thatnumber = $(this).siblings('.blockinfo').attr('data-id');
                    thatnumber = '#'+thatnumber;
                    var thatblock = $(thatnumber);//cache
                    var $selectedrow = thatblock.parent();
                    data_width = parseInt(thatblock.attr('data-width'));
                    var data_divide = parseInt($selectedrow.attr('data-divide'));
                    data_divide = data_divide - data_width ;
                    $selectedrow.attr('data-divide',data_divide);

                    $selectedrow.children('.dynamicblock').each(function(){

                        var $this = $(this);
                        data_width = $this.attr('data-width');
                        data_width = parseInt(data_width);
                        blockwidth = (100/data_divide)*data_width;
                        $this.children('p').children('span').text(Math.round(blockwidth));
                        blockwidth = blockwidth + '%';
                        $this.css('width', blockwidth);
                    

                    });

                    thatblock.remove(); //remove it
                    reallocatewidths($selectedrow);
                    deleteleft($selectedrow);
                    refresh();
                
                });
}
var subrowfun = function  () {
                addsubrow.unbind('click');//not sure why?
                addsubrow.on("click",function  () {
                   var thatnumber = $(this).siblings('.blockinfo').attr('data-id');
                   thatnumber = '#'+thatnumber;
                   var thatblock = $(thatnumber);//cache
                   var thesubrow='<div class="subrow" data-divide="0"><div class="subcolwrapper"><div class="addsubcol"></div></div></div>';
                   $(thesubrow).appendTo(thatblock);
                   //For the Height
                   var noofsubrows = parseInt(thatblock.attr('data-height'));
                   noofsubrows=noofsubrows+1;
                   thatblock.attr('data-height',noofsubrows);
                   var subrowheight = (100/noofsubrows)+'%';
                   thatblock.children('.subrow').css('height',subrowheight);
                    refresh();
                });
}
var subcolfun = function  () {

                   addsubcol.unbind("click");
                   addsubcol.on("click",function  () {
                      var thatsubrow=$(this).parent().parent();
                      data_divide = parseInt(thatsubrow.attr('data-divide'));
                      data_divide=data_divide+1;
                      thatsubrow.attr('data-divide',data_divide);
                      var subcolkahtml = '<div class="subcol"></div>';
                      $(subcolkahtml).appendTo(thatsubrow.children('.subcolwrapper'));
                      var width = (100/data_divide)+'%';
                      thatsubrow.find('.subcol').css('width',width);


                   });
}
 var refresh = function  () {
    remove = $('.remove');
    left = $('.left');
    right = $('.right');
    addsubrow = $('.addsubrow');
    addsubcol = $('.addsubcol');
    rightfun();leftfun();removefun();subcolfun();subrowfun();
}
 var intoolbox = function  ($selected) {
        $beforeselected.css('background-color','white');
        $selected.css('background-color','lightblue');
        var thatblockinfo = $selected.find('.blockinfo');
        var htmlcode = $selected.children('.fixedblockoptions').html();
        $('#toolbox').html(htmlcode);
        refresh();
        
        //Live Edit will change at 4 places
        $('.editblockid').editInPlace({

        callback: function (idOfEditor, enteredText, orinalHTMLContent, settingsParams, animationCallbacks) {
            $(this).attr('data-id', enteredText);
            thatblockinfo.children('.editblockid').attr('data-id',enteredText);
            thatblockinfo.children('.editblockid').text(enteredText);
            return enteredText;
                }

            });

        $('.editblockclass').editInPlace({

            callback: function (idOfEditor, enteredText, orinalHTMLContent, settingsParams, animationCallbacks) {
                        $(this).attr('data-class', enteredText);
                thatblockinfo.children('.editblockclass').attr('data-class',enteredText);
                thatblockinfo.children('.editblockclass').text(enteredText);
                return enteredText;
                    }

            });

                $('.editblockcomment').editInPlace({

            callback: function (idOfEditor, enteredText, orinalHTMLContent, settingsParams, animationCallbacks) {
            $(this).attr('data-comment', enteredText);
            thatblockinfo.children('.editblockcomment').attr('data-comment',enteredText);
            thatblockinfo.children('.editblockcomment').text(enteredText);
            return enteredText;
                    }
            });
            $beforeselected = $selected;
    }
    //change all the data-widths & data-divide
    var reallocatewidths = function  ($selectedrow) {

        var divisor = parseInt($selectedrow.attr('data-divide'));
        data_divide = divisor;
        $selectedrow.children('.dynamicblock').each(function(){

             data_width = parseInt($(this).attr('data-width'));
             
             divisor=gcd(data_width,divisor);
             
        });
        
        $selectedrow.children('.dynamicblock').each(function(){

            data_width = parseInt($(this).attr('data-width'));
            data_width = data_width /divisor ;
            $(this).attr('data-width',data_width);
        });
        
        data_divide = data_divide / divisor ; 
        $selectedrow.attr('data-divide',data_divide);

    }
    //Find The GCD
    function gcd(x, y) {
        while (y != 0) {
            var z = x % y;
            x = y;
            y = z;
        }
        return x;
    }

    var deleteleft = function  ($selectedrow) {
        
         $selectedrow.find('.dynamicblock').each(function(){

            data_width = parseInt($(this).attr('data-width'));
            if (data_width===1) {
                $(this).find('.left').hide();
            }

        });

    }
    var generatecode = function () {

            var $this='';
            var rowinfo ='';
            var therowid ='';
            var therowclass ='';
            var therowcommnet ='';
            //the start
            awesomecss = awesomecss + '\n/*These are all the widths of elements*/\n';
            //the two main loops 
            // the first loop for rows
            $('.dynamicrow').each(function (rownumber) {

                //these variables are for ids clases and objects
                var theblockid = '';
                var theblockclass = '';
                var blockobject ='';
                var blockinfo = '';

                $this = $(this); //cache
                data_divide = $this.attr('data-divide');//important
                rowinfo = $this.find('blockinfo');
                therowid = rowinfo.children('.editblockid').attr('data-id');
                therowclass = rowinfo.children('.editblockclass').attr('data-class');
                therowcomment = rowinfo.children('.editblockcomment').attr('data-comment');
                
                awesomecontent = awesomecontent + '\t<div '; //code
                if (typeof therowid !== "undefined" && therowid !== "") {
                        awesomecontent = awesomecontent + 'id="' + therowid + '"';
                    };
                awesomecontent = awesomecontent +'class="row';
                if (typeof therowclass !== "undefined" && therowclass !== "") {
                        awesomecontent = awesomecontent + therowclass ;
                    };
                awesomecontent = awesomecontent +'">\n';
                if (typeof therowcomment !== "undefined" && therowcomment !== "") {
                        awesomecontent = awesomecontent +'\t<!--'+therowcomment +'-->';
                    };

                //***the second loop for blocks****

                $this.children('.dynamicblock').each(function () {

                    blockobject = $(this);
                    blockinfo = blockobject.find('.blockinfo');
                    theblockid = blockinfo.children('.editblockid').attr('data-id'); //id
                    theblockclass = blockinfo.children('.editblockclass').attr('data-class'); //class
                    theblockcomment = blockinfo.children('.editblockcomment').attr('data-comment'); //commenet
                    data_width = blockobject.attr('data-width');
                    data_height=parseInt(blockobject.attr('data-height'));
                    if (data_height!==0)
                    {
                        if(typeof theblockid === "undefined" || theblockid === "") 
                        {

                            theblockid='block'+number.toString();
                            number=number+1;
                        }
                        cssforheights=cssforheights+'\n#'+theblockid+'>.subrow{\n\theight:'+(100/data_height)+'%;\n}';
                    }
                    block_ka_html = '\n\t\t<div id="' + theblockid + '" class="col span_'+data_width+'_of_' + data_divide + ' ' + theblockclass + '">\n'; //code

                    if (typeof theblockcomment !== "undefined" && theblockcomment !== "") {
                        block_ka_html = block_ka_html + '\t\t<!--' + theblockcomment + '-->';
                    }

                    //for the css
                    //if loop for no repeatation
                    if (jQuery.inArray(dividewidth, widtharray)===-1) {

                    dividewidth=data_width*10+data_divide;
                    percent = (data_width/data_divide)*100;
                    awesomecss = awesomecss + '.span_'+data_width+'_of_'+data_divide+'{ width :'+percent+'%;}\n';
                    mediaqueries = mediaqueries + '.span_'+data_width+'_of_'+data_divide+'{ width : 100%;}\n';
                    widtharray.push(dividewidth);
                    };

                    //3rd loop for subrows
                    blockobject.find('.subrow').each(function () {
                        subrowobject = $(this);
                        datadividesub = subrowobject.attr('data-divide');
                        block_ka_html=block_ka_html+'\n\t\t\t<div class="subrow">';

                        //4rd loop
                        subrowobject.find('.subcol').each(function() {
                            
                            block_ka_html = block_ka_html+'\n\t\t\t\t<div class="col span_1_of_' + datadividesub+'">\n\t\t\t\t</div>';
                            dividewidth=10+datadividesub;
                            if (jQuery.inArray(dividewidth, widtharray)===-1) {

                            percent = 100/datadividesub;
                            awesomecss = awesomecss + '.span_1_of_'+datadividesub+'{ width :'+percent+'%;}\n';
                            mediaqueries = mediaqueries + '.span_1_of_'+datadividesub+'{ width : 100%;}\n';
                            widtharray.push(dividewidth);

                            }
                        });
                        block_ka_html=block_ka_html+'\n\t\t\t</div>';//close-subrow

                    })
                    awesomecontent = awesomecontent + block_ka_html + '\n\t\t</div>';
                    //close for block

                });
                awesomecontent = awesomecontent + '\n\t</div>\n';//close for rows

                //Give heights to the differene rows
                rownumber=rownumber+1;
                heights = heights + '\n.row:nth-of-type(' + rownumber + '){\n\theight:' + Math.round($this.height() + 1) + 'px;\n}\n';

        });
                
     }   
             
});
</script>
</body>
</html>